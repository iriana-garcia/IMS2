<ui:composition template="/secure/default.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:sec="http://www.springframework.org/security/tags">

	<ui:define name="body">


		<style>
.pngRol tbody td {
	border-width: 0px;
}
</style>

		<h:form id="form"
			onkeypress="if( event.keyCode == 13){if(document.activeElement.type == 'submit' || document.activeElement.type == 'button' || document.activeElement.type == 'reset') return true; else return false;}">

			<p:toolbar>
				<f:facet name="left">
					<h:outputText value="#{msg.phone_system_skill}" />
				</f:facet>
				<f:facet name="right">
					<p:commandButton value="#{msg.print}" icon="ui-icon-print"
						actionListener="#{printController.printListTable}"
						styleClass="buttonBarra" update="messages"
						oncomplete="PF('dlgPrint').show();">
						<f:attribute name="report" value="15" />
						<f:attribute name="title" value="phone_system_skill" />
					</p:commandButton>

				</f:facet>
			</p:toolbar>


			<h:panelGrid styleClass="panel" columns="1" id="panel">



				<h:panelGrid border="0" columns="1">
					<p:messages id="messages" showDetail="false" autoUpdate="true" />
				</h:panelGrid>

				<p:remoteCommand name="refreshFooter"
					update="form:uniTable:rowCount" />

				<p:remoteCommand name="refreshState"
					oncomplete="PF('wdvState').selectValue(true)" />



				<p:growl id="msgs" showDetail="false" />



				<p:dataTable var="uni"
					value="#{skillPhoneSystemController.lazyModel}" paginator="true"
					rows="20" paginatorPosition="bottom"
					paginatorTemplate=" {RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {CurrentPageReport} "
					rowsPerPageTemplate="#{constant.rowsToShow}"
					widgetVar="uniTableFil" id="uniTable" lazy="true"
					resizableColumns="true" draggableColumns="true"
					sortBy="#{uni.name}" sortOrder="ascending" editable="true"
					style="min-width: 600px !important" selectionMode="single">

					<p:ajax event="rowEdit"
						listener="#{skillPhoneSystemController.onRowEdit}"
						update=":form:msgs" ignoreAutoUpdate="true">
					</p:ajax>
					<p:ajax event="rowEditCancel"
						listener="#{skillPhoneSystemController.onRowCancel}"
						update=":form:msgs" ignoreAutoUpdate="true" />

					<f:facet name="header">
						<p:outputPanel>

							<p:commandButton value="Filters" icon="ui-icon-search"
								id="btnFilter" onclick="PF('dlgFilter').show();"
								rendered="false" />

							<p:spacer width="10" rendered="false" />


							<p:commandButton value="Clear filters"
								actionListener="#{skillPhoneSystemController.clearFilter}"
								icon="ui-icon-close" id="btnReset" update="form:uniTable"></p:commandButton>

							<p:spacer width="10" rendered="false" />

							<p:commandButton id="toggler" type="button" value="Columns"
								icon="ui-icon-calculator" rendered="false" />
							<p:columnToggler datasource="uniTable" trigger="toggler"
								rendered="false" />

						</p:outputPanel>
					</f:facet>

					<p:ajax event="filter" oncomplete="refreshFooter()"></p:ajax>
					<f:facet name="footer">
						<h:outputText id="rowCount"
							value="#{msg.total_register} #{skillPhoneSystemController.lazyModel.rowCount}" />
					</f:facet>


					<p:column headerText="#{msg.name}" sortBy="#{uni.name}"
						filterBy="#{uni.name}" filterStyle="width: 90% !important">
						<h:outputText value="#{uni.name}" />
					</p:column>

					<p:column headerText="#{msg.place}" sortBy="#{uni.place}"
						filterBy="#{uni.place}" filterStyle="width: 90% !important"
						width="150">
						<h:outputText value="#{uni.place}" />
					</p:column>

					<p:column headerText="#{msg.phone_system_id}"
						sortBy="#{uni.phoneSystemId}" filterBy="#{uni.phoneSystemId}"
						filterStyle="width: 90% !important" width="150">
						<h:outputText value="#{uni.phoneSystemId}" />
					</p:column>

					<p:column headerText="#{msg.skill}" sortBy="#{uni.skill.name}"
						filterBy="#{uni.skill.name}" filterStyle="width: 90% !important">

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{uni.skill.name}" />
							</f:facet>
							<f:facet name="input">
								<h:panelGrid border="0" styleClass="pngRol" columns="1"
									columnClasses="columSize">
									<p:selectOneMenu id="cmbCa" value="#{uni.skill}"
										converter="entityConverter" filter="true"
										style="width: 200px;" filterMatchMode="contains"
										required="false">
										<f:selectItem itemLabel="#{msg.select_one}"
											itemValue="#{null}" noSelectionOption="true" />
										<f:selectItems value="#{skillController.listActive}" var="ca"
											itemLabel="#{ca.name}" itemValue="#{ca}" />
									</p:selectOneMenu>
								</h:panelGrid>
							</f:facet>

						</p:cellEditor>
					</p:column>


					<p:column headerText="#{msg.type}" sortBy="#{uni.type}"
						filterBy="#{uni.type}" filterStyle="width: 90% !important"
						width="200">
						<f:facet name="filter">
							<p:selectOneMenu onchange="PF('uniTableFil').filter()"
								id="cmbType">
								<f:selectItem itemLabel="#{msg.select_all}" itemValue="#{null}"
									noSelectionOption="true" />
								<f:selectItems
									value="#{skillPhoneSystemController.listTypeSkill}" var="t"
									itemValue="#{t[0]}" itemLabel="#{t[1]}"></f:selectItems>
							</p:selectOneMenu>
						</f:facet>

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{uni.typeName}" />
							</f:facet>
							<f:facet name="input">
								<h:panelGrid border="0" styleClass="pngRol" columns="1"
									columnClasses="columSize">
									<p:selectOneMenu value="#{uni.type}">
										<f:selectItems
											value="#{skillPhoneSystemController.listTypeSkill}" var="t"
											itemValue="#{t[0]}" itemLabel="#{t[1]}"></f:selectItems>
									</p:selectOneMenu>
								</h:panelGrid>
							</f:facet>

						</p:cellEditor>

					</p:column>

					<p:column headerText="#{msg.state}" sortBy="#{uni.state}"
						width="150" filterBy="#{uni.state}"
						filterStyle="width: 90% !important">
						<f:facet name="filter">
							<p:selectOneMenu onchange="PF('uniTableFil').filter()"
								id="cmbError">
								<f:selectItem itemLabel="#{msg.select_all}" itemValue="#{null}"
									noSelectionOption="true" />
								<f:converter converterId="javax.faces.Boolean" />
								<f:selectItem itemValue="true" itemLabel="#{msg.active}"></f:selectItem>
								<f:selectItem itemValue="false" itemLabel="#{msg.deactive}"></f:selectItem>
							</p:selectOneMenu>
						</f:facet>
						<h:outputText value="#{uni.state ? msg.active : msg.deactive}" />
					</p:column>

					<sec:authorize access="hasAnyRole('SUPER','CA_M')">
						<p:column style="width:20px" toggleable="false">
							<p:rowEditor rendered="#{uni.state}" />
						</p:column>
					</sec:authorize>


				</p:dataTable>


				<ui:include src="/secure/confirmation_modify.xhtml"></ui:include>
			</h:panelGrid>



		</h:form>

		<ui:include src="/secure/dialog_add_category.xhtml"></ui:include>

		<ui:include src="/secure/select_format.xhtml"></ui:include>


	</ui:define>

</ui:composition>